"use strict";function ownKeys(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach(function(e){_defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(r="Object"===r&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o=[],i=!0,s=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){s=!0,a=e}finally{try{i||null==r.return||r.return()}finally{if(s)throw a}}return o}}function _arrayWithHoles(e){if(Array.isArray(e))return e}var scriptParameters={IS_DEV:document.currentScript.getAttribute("is-dev")||!1,UNIT:document.currentScript.getAttribute("unit")||"FINCLASS",IS_ACTIVE_CAMPAIGN:document.currentScript.getAttribute("is-active-campaign")||!0,EVENT_SOURCE:document.currentScript.getAttribute("event-source")||"",EVENT_ACTION:document.currentScript.getAttribute("event-action")||"",EVENT_CAMPAIGN:document.currentScript.getAttribute("event-campaign")||"",STARLINK_URL:document.currentScript.getAttribute("starlink-url")||"",REDIRECT_URL_AFTER_SUBMIT:document.currentScript.getAttribute("redirect-url-after-submit")||"",SHOW_MESSAGE:document.currentScript.getAttribute("show-error-message")||!0};window.addEventListener("leadsCaptureSubmit",function(e){onSubmitLeadForm(!1,e.detail.form)},!1);var activeCampaignURL="https://lm.timeprimo.com/app/lead/subscribe",starlinkSearchDevURL="https://starlink.timeprimo.com/dev/user/search",starlinkSearchProdURL="https://starlink.timeprimo.com/app/user/search",starlinkUpdateDevURL="https://starlink.timeprimo.com/dev/user/update",starlinkUpdateProdURL="https://starlink.timeprimo.com/app/user/update",forms=document.querySelectorAll("form.form"),submitCtas=document.querySelectorAll(".submit-button");function onSubmitLeadForm(e,t){var r,n,a,o,i=new FormData(t),s=Array.from(i.entries()),c=t.querySelector(".submit-button"),u=(null==c?void 0:c.textContent)||(null==c?void 0:c.value),l=!1,d={},m="";s.forEach(function(e){var t=_slicedToArray(e,2),r=t[0],n=t[1],e=document.getElementById(r),t="email"===r;!(d[r]=n)&&t?(null!=e&&e.classList.add("error"),l=!0):null!=e&&e.classList.remove("error"),scriptParameters.REDIRECT_URL_AFTER_SUBMIT.includes("/register")&&(m+="".concat(r,"=").concat(n,"&"))}),!l&&scriptParameters.EVENT_SOURCE&&(r=new Headers,o={},r.append("Content-Type","application/json"),e&&!scriptParameters.STARLINK_URL?(o=_objectSpread(_objectSpread({},d),{},{unit:scriptParameters.UNIT,tag:scriptParameters.EVENT_SOURCE,meta:{origin:window.location.href}}),sendLeadData(activeCampaignURL,r,o,m,c,u)):(s=scriptParameters.IS_DEV?starlinkSearchDevURL:starlinkSearchProdURL,n=scriptParameters.IS_DEV?starlinkUpdateDevURL:starlinkUpdateProdURL,o={userEmail:i.get("email"),userFirstname:(null===(e=i.get("name"))||void 0===e?void 0:e.split(" ")[0])||"",userLastname:(null===(e=i.get("name"))||void 0===e?void 0:e.split(" ").slice(1).join(" "))||""},i.get("phone")&&null!==(a=i.get("phone"))&&void 0!==a&&a.length&&(a=11<cleanPhoneInput(i.get("phone")).length?cleanPhoneInput(i.get("phone")).substring(0,2):null,o=_objectSpread(_objectSpread({},o),{},{userPhone:{userPhoneDDI:a||"55",userPhoneNumber:a?cleanPhoneInput(i.get("phone")).substring(2):cleanPhoneInput(i.get("phone"))}})),setLoadingText(c),fetch(s,{method:"POST",headers:r,body:JSON.stringify(o),redirect:"follow"}).then(function(e){return e.json()}).then(function(e){e.data.isNew?(o={SL_ID:e.data.user.SL_ID,unit:scriptParameters.UNIT,eventSource:scriptParameters.EVENT_SOURCE,eventAction:scriptParameters.EVENT_ACTION,eventCampaign:scriptParameters.EVENT_CAMPAIGN,eventMeta:{url:window.location.href}},sendLeadData(scriptParameters.STARLINK_URL,r,o,m,c,u)):fetch("".concat(n,"/").concat(e.data.user.SL_ID),{method:"POST",headers:r,body:JSON.stringify(o),redirect:"follow"}).then(function(e){return e.json()}).then(function(e){o={SL_ID:e.data.user.SL_ID,unit:scriptParameters.UNIT,eventSource:scriptParameters.EVENT_SOURCE,eventAction:scriptParameters.EVENT_ACTION,eventCampaign:scriptParameters.EVENT_CAMPAIGN,eventMeta:{url:window.location.href}},sendLeadData(scriptParameters.STARLINK_URL,r,o,m,c,u)})}).catch(function(){setLoadingText(c,u),console.error(err),scriptParameters.SHOW_MESSAGE&&showMessage(!1)})))}function sendLeadData(e,t,r,n,a,o){fetch(e,{method:"POST",headers:t,body:JSON.stringify(r)}).then(function(e){return e.json()}).then(function(e){setLoadingText(a,o),e.status?(e=new CustomEvent("leadsCaptureSubmitSuccess"),window.dispatchEvent(e),scriptParameters.REDIRECT_URL_AFTER_SUBMIT?redirect(n):scriptParameters.SHOW_MESSAGE&&showMessage(!0)):scriptParameters.SHOW_MESSAGE&&showMessage(!1)}).catch(function(e){setLoadingText(a,o),console.error(e),scriptParameters.SHOW_MESSAGE&&showMessage(!1)})}function setLoadingText(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";e&&(e.disabled=!t,e.value?e.value=t||"Carregando...":e.textContent&&(e.textContent=t||"Carregando..."))}function redirect(e){e=(window.location.search?"".concat(window.location.search,"&"):"?").concat(e),e="".concat(scriptParameters.REDIRECT_URL_AFTER_SUBMIT).concat(e);window.location.href=e}function showMessage(e){var t="",e=e?(t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"Seus dados foram cadastrados com sucesso!","submit-success"):(t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"Infelizmente tivemos um problema ao cadastrar sua conta. Por favor, tente novamente mais tarde!","submit-error"),r=document.getElementById(e);r&&(r.classList.add("visible"),r.textContent=t,setTimeout(function(){r.classList.remove("visible"),r.textContent=""},4e3))}function cleanPhoneInput(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";return"string"==typeof e?e.replace(/[- )(]/g,""):""}null!=forms&&forms.forEach(function(t){t.addEventListener("submit",function(e){e.preventDefault(),onSubmitLeadForm(!!scriptParameters.IS_ACTIVE_CAMPAIGN,t)})}),null!=submitCtas&&submitCtas.forEach(function(e,t){e.addEventListener("click",function(e){e.preventDefault(),onSubmitLeadForm(!!scriptParameters.IS_ACTIVE_CAMPAIGN,forms[t])})});